<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<meta name="author" content="Simon Weber">
    
    <meta name="description" content="I look back on my work on gmusicapi." />
    
	<link href="http://feeds.feedburner.com/SimonWeber" rel="alternate" title="Simon Weber" type="application/atom+xml" />
	<title>gmusicapi retrospective</title>

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, user-scalable=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="/stylesheets/base.css">
	<link rel="stylesheet" href="/stylesheets/skeleton.css">
	<link rel="stylesheet" href="/stylesheets/layout.css">

	<link rel="stylesheet" href="/stylesheets/custom.css">
	<link rel="stylesheet" href="/stylesheets/pygments.css">

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Favicons
	================================================== -->
	<link rel="shortcut icon" href="/images/favicon.ico">
	<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

</head>
<body>



    <!-- Primary Page Layout
    ================================================== -->
    <div class="container">
        <div class="four columns sidebar">
            <ul>
                <li><h3 id="logo"><a href="/index.html">Simon Weber</a></h3></li>
                <li><a href="mailto:simon@simonmweber.com">simon@simonmweber.com</a></li>
                <li>

                <div class="favicon five-spaced row">
                    <span><a href="https://github.com/simon-weber"><img alt="simon-weber" src="/images/github.ico"></a></span>
                    <span><a href="http://www.facebook.com/simon.weber1"> <img alt="simon.weber1" src="/images/facebook.ico"></a></span>
                    <span><a href="https://plus.google.com/103350848301234480355"> <img alt="Simon Weber" src="/images/plus.ico"></a></span>
		  <span><a href="http://news.ycombinator.com/user?id=simon_weber"> <img alt="simon_weber" src="/images/hn.ico"></a></span>
          <span><a href="https://twitter.com/#!/simonmweber"> <img alt="simonmweber" src="/images/twitter.ico"></a></span>
      </div>
      </li>
  </ul>

	    &nbsp;
    </div>

	  
    <div class="eleven columns offset-by-one content">
        <div id="post">
    <h2 id='gmusicapi_retrospective'>gmusicapi retrospective</h2>
<p class='meta'>14 May 2013</p>
<p>gmusicapi has come a long way since I pushed my <a href='https://github.com/simon-weber/Unofficial-Google-Music-API/commit/880fcb3063e5ed3ba7179f1a9c8fda8c41f1dd6a'>first commit</a> back in January 2012.</p>

<p>The project has grown more than usual during this semester, since &#8211; for the first time &#8211; I worked on it for school credit. Here&#8217;s what I spent my time on:</p>

<ul>
<li>a number of big features: scan-and-match support, album art operations, Music Manager OAuth support, python 2.6 compatibility&#8230;</li>

<li>a new dynamic testing system for my end-to-end tests</li>

<li>a huge rewrite to allow for more flexible protocol declarations</li>

<li>continuous integration that also catches protocol changes</li>

<li>documentation improvements and a new irc support channel</li>

<li>version 1.0!</li>
</ul>

<p><a href='https://github.com/simon-weber/Unofficial-Google-Music-API/graphs'>Github&#8217;s graphs</a> provide a quick overview of what I&#8217;ve been up to. Here are a few other metrics:</p>

<ul>
<li>documentation visits x5, bounce rate halved</li>

<li>PyPi download rate x2</li>

<li>use in a couple of real-world products</li>
</ul>

<p>I figure this is a good chance to reflect on some of the decisions I&#8217;ve made, both for my sake and for those who might come this way in the future.</p>

<h3 id='dont_count_out_endtoend_testing'>Don&#8217;t count out end-to-end testing</h3>

<p>I have a few unit tests, but the majority of my tests are end-to-end black-box tests that exercise my clients against actual Google servers. Naturally, they violate core unit test principles: they&#8217;re stateful, cannot be run offline, and run slowly.</p>

<p>One thing I&#8217;ve learned while coming to this solution: there&#8217;s a lot of dogma surrounding test strategies.</p>

<p>It&#8217;s not that I&#8217;m against unit testing. I&#8217;d love to have more unit tests! Unfortunately, writing them isn&#8217;t free, and in my case, end-to-end tests offer more bang for my buck. I get more coverage with less code and get to test my expectations about Google&#8217;s servers. gmusicapi is also pretty small, so the loss of granularity when bug-hunting isn&#8217;t a huge deal.</p>

<p>Of course, there&#8217;s some extra work required to make your end-to-end tests robust. Backend flakiness can be addressed with retry and backoff. Test dependence and state management can be handled with TestNG-like frameworks (I use <a href='http://pythonhosted.org/proboscis/'>Proboscis</a>). Protocol changes can be caught by validating responses against a schema.</p>

<p>Currently, I have a few Google accounts I use exclusively for testing, and I keep their credentials in TravisCI encrypted variables. There&#8217;s one big downside to this: encrypted variables can&#8217;t be used with other folks&#8217; pull requests. In the future, I hope to figure out a way to safely manage a public test account (I think it&#8217;s possible with 2-factor auth).</p>

<h3 id='invest_in_support'>Invest in support</h3>

<p>I have trouble saying no to requests for help. Interestingly, gmusicapi also seems to attract many users who are new to Python. Because of these factors, I used to spend a fair amount of time answering support emails. I didn&#8217;t mind this, but after receiving a few emails on the same topics, I figured it&#8217;d be better to flesh out the <a href='http://unofficial-google-music-api.readthedocs.org'>gmusicapi documentation</a>.</p>

<p>Basic questions were addressed with installation and getting starting sections. These were no-brainers, and I should have added them earlier.</p>

<p>I also added a section for a less obvious topic: people want the reverse-engineered protocols I&#8217;m using. So far, I&#8217;ve thrown together a hack that introspects my protocol declaration code, but I&#8217;ve got plenty of room to improve this.</p>

<p>The <a href='http://webchat.freenode.net/?channels=gmusicapi'>#gmusicapi irc channel on Freenode</a> is another recent support addition. I wish I&#8217;d set it up earlier! Recently, devs building on gmusicapi have started hanging out and answering questions, which has been a huge help.</p>

<p>I still go the extra mile when I do direct support. Helping users out is its own reward, but I&#8217;m also flattered to have received thank-you emails after irc chats, money, and &#8211; once &#8211; even a gift in the mail!</p>

<h3 id='looking_forward'>Looking forward</h3>

<p>I&#8217;m very pleased with what I&#8217;ve learned and accomplished so far. My next step is to get the project into a self-sustaining state. I figure this means knocking out todos, beefing up internal documentation, and refactoring all of the wonky bits that have accumulated over time.</p>

<p>Thankfully, I&#8217;ll have plenty of time this summer at <a href='http://hackerschool.com'>Hacker School</a>!</p>
</div>

<div id="post-footer">
    <hr>
    <div id="subscribe">
        <p>
        <a href="http://feeds.feedburner.com/SimonWeber"><img src="/images/rss.png" alt="Subscribe to RSS Feed" /></a>
        </p>
    </div>
</div>

    </div>
</div><!-- container -->



	<!-- JS
	     ================================================== -->
	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script src="/javascripts/tabs.js"></script>
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-29570993-2']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

<!-- End Document
================================================== -->
</body>
</html>
